# Инструкция по запуску и проверке проекта BionicPRO

Данный проект содержит реализацию 4-х задач спринта, объединенных в единую микросервисную архитектуру. Код приведен к финальному состоянию (Задача 4), что позволяет проверить все функции одновременно.

## Требования
*   Docker
*   Docker Compose

## Быстрый старт

1.  **Запуск всех сервисов:**
    ```bash
    bash scripts/start_project.sh
    ```
    *Скрипт соберет Docker-образы, запустит контейнеры, применит схемы БД (ClickHouse), инициализирует CDC (Debezium) и заполнит тестовые данные.*

2.  **Доступ к интерфейсу:**
    *   Frontend: [http://localhost:3000](http://localhost:3000)
    *   Keycloak: [http://localhost:8080](http://localhost:8080)
    *   Minio Console: [http://localhost:9001](http://localhost:9001) (user: `minioadmin`, pass: `minioadmin`)

## Проверка Задач

Для каждой задачи подготовлен скрипт проверки, демонстрирующий работу функционала.

### Задача 1: Безопасность и BFF
Архитектура аутентификации через Keycloak и BFF сервис.
*   **Проверка:**
    ```bash
    bash scripts/verify_task1.sh
    ```
    *Проверяет доступность BFF, настройки Keycloak и защищенность эндпоинтов.*

### Задача 2: Сервис отчетов
Генерация отчетов из OLAP (ClickHouse) и ETL процессов.
*   **Проверка:**
    ```bash
    bash scripts/verify_task2.sh
    ```
    *Запрашивает отчет для тестового пользователя `user1`. Демонстрирует получение JSON данных.*

### Задача 3: Кэширование (S3 + CDN)
Снижение нагрузки через кэширование отчетов в S3 и раздачу через Nginx.
*   **Проверка:**
    ```bash
    bash scripts/verify_task3.sh
    ```
    *Выполняет запрос отчета, проверяет наличие поля `report_url` и скачивает файл через CDN (Nginx).*

### Задача 4: CDC (Change Data Capture)
Репликация данных из CRM (Postgres) в ClickHouse в реальном времени.
*   **Проверка:**
    ```bash
    bash scripts/verify_task4.sh
    ```
    *Добавляет нового пользователя в Postgres и проверяет, что он автоматически появился в отчетах (через ClickHouse) без запуска ETL.*

## Структура проекта
*   `frontend/`: React приложение.
*   `bionicpro-auth/`: BFF сервис (Auth).
*   `reports-service/`: Сервис отчетов (API).
*   `dags/`: Airflow DAGs (для исторической справки Task 2).
*   `scripts/`: Скрипты инициализации и проверки.
*   `TaskX/`: Артефакты решений по задачам.
